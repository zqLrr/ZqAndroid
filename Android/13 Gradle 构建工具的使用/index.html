
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="个人技术wiki">
      
      
        <meta name="author" content="Zq">
      
      
      
        <link rel="prev" href="../12%20Otto%E5%BA%93%E3%80%81IPCOtto%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/">
      
      
        <link rel="next" href="../14%20Service/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>Gradle 构建工具的使用 - ZqAndroid</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b4a2bd9.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#13-android" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="ZqAndroid" class="md-header__button md-logo" aria-label="ZqAndroid" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZqAndroid
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Gradle 构建工具的使用
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ZqAndroid" class="md-nav__button md-logo" aria-label="ZqAndroid" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ZqAndroid
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Android
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Android
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../1%E5%AE%89%E5%8D%93%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android 初识
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../2Android%E5%A4%A7%E7%BA%B2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android 大纲
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../1Acticity%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%92%8C%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activity 启动流程和启动模式源码解析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../1Activity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../2Boradcast%20Receiver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broadcast Receiver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../3Service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../3View%E6%8E%A7%E4%BB%B6%E5%92%8C%E5%B8%83%E5%B1%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    View控件和布局
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../4%E5%A4%9A%E5%AA%92%E4%BD%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    多媒体
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../4ContentProvider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ContentProvider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../5Android%20%E7%9A%84%E6%B6%88%E6%81%AF%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B6%E2%80%94%E2%80%94Handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android 的消息传递机制——Handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../5Application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../6Android%20Lint%20%E2%80%94%E2%80%94%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E7%9A%84%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android Lint ——代码优化的扫描工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../7Android%20%E6%9D%82%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android 杂记
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../8Android%E6%B7%B7%E6%B7%86%E2%80%94%E2%80%94proguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android混淆——proguard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../9%E6%9A%97%E9%BB%91%E6%A8%A1%E5%BC%8F%28%E6%B7%B1%E8%89%B2%E4%B8%BB%E9%A2%98%29%E9%80%82%E9%85%8D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    暗黑模式(深色主题)适配
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../10Android%20Crash%20%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android Crash 分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../11%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    设计模式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../12%20Otto%E5%BA%93%E3%80%81IPCOtto%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Otto库、IPCOtto库的使用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Gradle 构建工具的使用
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Gradle 构建工具的使用
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gradle" class="md-nav__link">
    Gradle 构建工具的使用
  </a>
  
    <nav class="md-nav" aria-label="Gradle 构建工具的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1gradleproperities" class="md-nav__link">
    1.gradle.properities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2buildgradle" class="md-nav__link">
    2.build.gradle
  </a>
  
    <nav class="md-nav" aria-label="2.build.gradle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build" class="md-nav__link">
    顶层Build文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_1" class="md-nav__link">
    模块Build文件
  </a>
  
    <nav class="md-nav" aria-label="模块Build文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buildscript" class="md-nav__link">
    buildscript{} 编译过程中的配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allprojects" class="md-nav__link">
    allprojects{} 整个项目需要依赖的仓库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ext" class="md-nav__link">
    ext{} 用来存放自己的自定义属性
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies{}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurationsall" class="md-nav__link">
    configurations.all{} 对所有配置进行统一更改
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildtypes-apk" class="md-nav__link">
    buildTypes{} 用于构建不同的Apk
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signingconfig" class="md-nav__link">
    signingConfig{}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sourcesets" class="md-nav__link">
    sourceSets{}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#afterevaluate" class="md-nav__link">
    afterEvaluate{}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndk" class="md-nav__link">
    NDK 配置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-buildgradle" class="md-nav__link">
    3.自定义 build.gradle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4build-variants" class="md-nav__link">
    4.Build variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5aab" class="md-nav__link">
    5.AAB格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6settingsgradle" class="md-nav__link">
    6.Settings.gradle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    编译性能优化工具
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../14%20Service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../15%20Android%20%E5%B8%B8%E7%94%A8%E4%B8%9A%E5%8A%A1%E5%8A%9F%E8%83%BD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android 常用业务功能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../17%20Jetpacket%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jetpacket基础学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../18%20RxJAVA%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RxJAVA 基础知识
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../19%20%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    音视频开发
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../20%20%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    性能优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../21Gson%E4%BD%BF%E7%94%A8%E5%92%8C%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gson使用和源码解析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../22%20Kotlin%20%E8%AF%AD%E6%B3%95%E5%85%A5%E9%97%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kotlin 语法入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../23%20OkDownLoad%20%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OkDownLoad 使用教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../24%20%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动化测试
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../25%20Apk%E5%A4%A7%E5%B0%8F%E4%BC%98%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apk大小优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../26%20AOSP%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AOSP源码学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../27%20JNI%20%E5%92%8C.SO%E5%85%A5%E9%97%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JNI 和.SO入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../28%20%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%96%B9%E6%A1%88%E5%A4%84%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内存泄漏方案处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../29%20Room%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Room数据库的使用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../30.%E7%BD%91%E7%BB%9C%E6%95%B4%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    网络整理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../31.%E9%B8%BF%E8%92%99%E5%BC%80%E5%8F%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    鸿蒙开发
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../33Android%20%E8%B5%84%E6%BA%90%E8%AF%A6%E8%A7%A3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android 资源详解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../34Compose%E7%9A%84%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compose的使用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%8F%8D%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%92%8C%E6%80%BB%E7%BB%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    反编译工具使用和总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%A8%A1%E5%9D%97%E9%97%B4%E9%80%9A%E4%BF%A1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    模块间通信
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%B5%8C%E5%A5%97%E6%BB%91%E5%8A%A8%E9%80%A0%E6%88%90%E7%9A%84%E6%BB%91%E5%8A%A8%E5%86%B2%E7%AA%81%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    嵌套滑动造成的滑动冲突原理分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%87%AA%E5%AE%9A%E4%B9%89View/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自定义View
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Android%20%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android 问题总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Android%20Demo%20%20200/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android Demo  200
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Android%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android工具使用教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../AppBarLayout%E7%9A%84%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AppBarLayout的使用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ContentProvider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ContentProvider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Fragment%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fragment的知识点
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Plugin%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugin 插件开发
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    前端
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            前端
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%89%8D%E7%AB%AF/%E8%B7%A8%E7%AB%AF%E7%BB%8F%E9%AA%8C%E5%BC%80%E5%8F%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    跨端经验开发
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%89%8D%E7%AB%AF/css/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    css
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%89%8D%E7%AB%AF/Preact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preact
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%89%8D%E7%AB%AF/Vue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vue
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    数据结构
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/1%E7%BB%AA%E8%AE%BA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1绪论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DevTools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            DevTools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../DevTools/docker%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker使用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../DevTools/Easy-Make本地搭建.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easy-Make本地搭建
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flutter
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Flutter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Flutter/Base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Java
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Java/JAVA%20%E7%BA%BF%E7%A8%8B%E8%AF%A6%E8%A7%A3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAVA 线程详解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Java/Java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java基础学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Java/Java%E5%BC%82%E5%B8%B8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java异常
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Java/Java%E6%B3%A8%E8%A7%A3%EF%BC%88Annotation%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java注解（Annotation）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Java/LeetCode%20%E9%A2%98%E8%A7%A3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LeetCode 题解
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Net
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Net
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Net/Http%E5%8D%8F%E8%AE%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Http协议
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Python/Python%20%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python 教程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ReadNotes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            ReadNotes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ReadNotes/Coding%20Easy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding Easy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SoftwareExam
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            SoftwareExam
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../SoftwareExam/%E5%B1%82%E6%AC%A1%E5%BC%8F%E6%9E%B6%E6%9E%84%E8%8C%83%E6%96%87/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    层次式架构范文
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../SoftwareExam/software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    software
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Spring-Boot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Spring-Boot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Spring-Boot/Spring-Boot%20%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring-Boot 框架
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/common%20tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    common tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gradle" class="md-nav__link">
    Gradle 构建工具的使用
  </a>
  
    <nav class="md-nav" aria-label="Gradle 构建工具的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1gradleproperities" class="md-nav__link">
    1.gradle.properities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2buildgradle" class="md-nav__link">
    2.build.gradle
  </a>
  
    <nav class="md-nav" aria-label="2.build.gradle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build" class="md-nav__link">
    顶层Build文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_1" class="md-nav__link">
    模块Build文件
  </a>
  
    <nav class="md-nav" aria-label="模块Build文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buildscript" class="md-nav__link">
    buildscript{} 编译过程中的配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allprojects" class="md-nav__link">
    allprojects{} 整个项目需要依赖的仓库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ext" class="md-nav__link">
    ext{} 用来存放自己的自定义属性
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies{}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurationsall" class="md-nav__link">
    configurations.all{} 对所有配置进行统一更改
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildtypes-apk" class="md-nav__link">
    buildTypes{} 用于构建不同的Apk
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signingconfig" class="md-nav__link">
    signingConfig{}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sourcesets" class="md-nav__link">
    sourceSets{}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#afterevaluate" class="md-nav__link">
    afterEvaluate{}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndk" class="md-nav__link">
    NDK 配置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-buildgradle" class="md-nav__link">
    3.自定义 build.gradle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4build-variants" class="md-nav__link">
    4.Build variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5aab" class="md-nav__link">
    5.AAB格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6settingsgradle" class="md-nav__link">
    6.Settings.gradle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    编译性能优化工具
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="13-android">13  Android 多模块开发和构建过程</h1>
<p>相关网址链接：</p>
<p>官方手册：https://docs.gradle.org/7.0.2/userguide/userguide.html</p>
<h2 id="gradle">Gradle 构建工具的使用</h2>
<p>简介</p>
<blockquote>
<p>从 Gradle 的角度看，我们知道 Android 其实就是 Gradle 的一个第三方插件，它是由 Google</p>
<p>的Android团队开发的。但是从Android的角度看，Android插件是基于Gradle构建的，和Android </p>
<p>Studio 完美无缝搭配的新一代构建系统。</p>
</blockquote>
<p>构建流程：</p>
<p><img alt="image-20220916104434668" src="../13%20Gradle%20%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8.assets/image-20220916104434668.png" /></p>
<h3 id="1gradleproperities">1.gradle.properities</h3>
<blockquote>
<p>为Gradle的属性配置文件，所有的.gradle 文件都可以使用这些属性</p>
</blockquote>
<pre><code class="language-java">//用法
Properties properties = new Properties()
properties.load(new FileInputStream(new File(project.rootProject.projectDir,&quot;local.properties&quot;)));//gradle.properties的文件地址
lacal =  properties.getProperty('local','false')
//或者 直接获取
  lacal =  rootProject.getProperty('local','false')
</code></pre>
<h3 id="2buildgradle">2.build.gradle</h3>
<blockquote>
<p>Gradle Code的主要文件，可以修改名称</p>
</blockquote>
<h4 id="build">顶层Build文件</h4>
<blockquote>
<p>顶层 <code>build.gradle</code> 文件位于项目的根目录下，用于定义适用于项目中所有模块的依赖项。默认情况下，顶层 build 文件使用 <code>plugins</code> 代码块定义项目中所有模块共用的 Gradle 依赖项。此外，顶层 build 文件还包含用于清理 build 目录的代码</p>
</blockquote>
<p>buildscript{}、allprojects{}、ext{}</p>
<pre><code class="language-groovy">task clean(type: Delete) {
    delete rootProject.buildDir
}
</code></pre>
<p>Gradle 7.0之后，顶层build文件功能分给了settings.gradle,现在主要是有以下功能：</p>
<pre><code class="language-groovy">// Top-level build file where you can add configuration options common to all sub-projects/modules.
plugins {
    id 'com.android.application' version '7.3.1' apply false
    id 'com.android.library' version '7.3.1' apply false
    id 'org.jetbrains.kotlin.android' version '1.7.20' apply false
}
</code></pre>
<p>在顶层模块直接指定了Gradle插件的版本。</p>
<h4 id="build_1">模块Build文件</h4>
<p>常用操作</p>
<pre><code class="language-groovy">//引用.gradle 文件
apply from: &quot;filename.gradle&quot;
//插件 library 声明
apply plugin: 'com.android.library'
</code></pre>
<p>Android常见五种插件id：</p>
<table>
<thead>
<tr>
<th>plugin id</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>com.android.application</td>
<td>应用程序插件，生成apk</td>
</tr>
<tr>
<td>com.android.library</td>
<td>库插件，生成aar，可供其它项目使用</td>
</tr>
<tr>
<td>com.android.test</td>
<td>测试插件</td>
</tr>
<tr>
<td>com.android.feature</td>
<td>创建Android Instant App时需要用到的插件</td>
</tr>
<tr>
<td>com.android.instantapp</td>
<td>Android Instant App的入口</td>
</tr>
</tbody>
</table>
<h5 id="buildscript">buildscript{} 编译过程中的配置</h5>
<h5 id="allprojects">allprojects{} 整个项目需要依赖的仓库</h5>
<blockquote>
<p>这一项在Gradle 7.0之后，将其放在了settings.gradle,但是也可以使用，但不要和这个冲突</p>
<p>```
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {</p>
<pre><code>    google()
    mavenCentral() 
}
</code></pre>
<p>}
```</p>
</blockquote>
<h5 id="ext">ext{} 用来存放自己的自定义属性</h5>
<h5 id="dependencies">dependencies{}</h5>
<blockquote>
<p>gradle 依赖的相关操作</p>
</blockquote>
<pre><code class="language-groovy">implementation fileTree(dir: 'libs', include: ['*.aar', '*.jar'], exclude: [])//依赖libs目录下的所有相关类型文件
implementation project(path: ':moudlename')//依赖本地文件
implementation files('libs/libraryname.jar')//依赖本地库
  implementation(group: 'com.sina.weibo.lib', name: 'ipc', version: '0.1.2-SNAPSHOT', ext: 'aar') { transitive = true //是否穿透 }//依赖远程库 需要在allprojects中添加maven仓库
</code></pre>
<p>dependencies的Api</p>
<table>
<thead>
<tr>
<th>Android Studio 2.X</th>
<th>Android Studio 3.X</th>
</tr>
</thead>
<tbody>
<tr>
<td>apk</td>
<td>runtimeOnly</td>
</tr>
<tr>
<td>provided</td>
<td>compileOnly</td>
</tr>
<tr>
<td>compile</td>
<td>api</td>
</tr>
<tr>
<td>没有对应</td>
<td>implementation</td>
</tr>
<tr>
<td>debugCompile</td>
<td>debugImplementation</td>
</tr>
<tr>
<td>releaseCompile</td>
<td>releaseImplementation</td>
</tr>
<tr>
<td>androidTestCompile</td>
<td>androidTestImplementation</td>
</tr>
</tbody>
</table>
<ul>
<li>implementation</li>
</ul>
<p>相当于private,不会将依赖传递到下一级,对于其他moudle是不可见的</p>
<ul>
<li>compile</li>
</ul>
<p>相当于public，会将依赖传递到下一级</p>
<ul>
<li>api</li>
</ul>
<p>完全等同于compile，是compile的升级版，现在使用api</p>
<ul>
<li>provided（compileOnly）</li>
</ul>
<p>​       只在编译时有效，不会参与打包</p>
<ul>
<li>apk（runtimeOnly）</li>
</ul>
<p>只在生成apk的时候参与打包，编译时不会参与，很少用。</p>
<ul>
<li>
<p>testCompile（testImplementation）
  testCompile 只在单元测试代码的编译以及最终打包测试apk时有效。</p>
</li>
<li>
<p>debugCompile（debugImplementation）
  debugCompile 只在debug模式的编译和最终的debug apk打包时有效</p>
</li>
<li>
<p>releaseCompile（releaseImplementation）
  Release compile 仅仅针对Release 模式的编译和最终的Release apk打包。</p>
</li>
<li>
<p>Android{}</p>
</li>
<li>
<p>compileSdk</p>
<p>compileSdkVersion告诉gradle使用哪个版本Android SDK编译你的应用，使用任何新添加的API就要使用对应level的Android SDK，但是该配置信息不会加在打包环境中，只是为IDE提供的编译环境。</p>
<p>推荐使用最新的SDK环境编译</p>
</li>
<li>
<p>minSdk</p>
<p>指明应用程序运行所需的最小API level，若用户的机型小于这个版本，则无法安装。同时不能使用该level版本SDK所不具备的API。</p>
<p>你的minSdkVersion要大于你依赖的所有库的minSdkVersion。</p>
<p>minSDK 决定了你使用的API 版本。</p>
<p>使用高于minSdkVersion的API，只是编译时会报警告，但是如果运行在低版本手机上，会以为api找不到导致crash</p>
</li>
<li>
<p>targetSdk</p>
<p>targetSdkVersion 是 Android 系统提供前向兼容的主要手段。意思就是在SDK版本更新后，根据targetSdk来维持原有的行为，假如你当前的targetSDK = 19,当Android系统更新到20时，行为不会发生变化，仍然按19来运行。</p>
<p>targetSdk决定了你运行的API版本。</p>
<p>每一Android系统会提供一套API，高版本的API兼容低版本的API。</p>
<p>使用低版本API的好处，可以兼容更多的机型。</p>
<p>使用高版本API的好处，提供了更多封装好的API,消除了低版本的一些问题和不足。</p>
<p>实际上三者之间的关系应该是：</p>
<p><code>java
minSdkVersion &lt;= targetSdkVersion &lt;= compileSdkVersion</code></p>
<p>因此，一般是使用minSdk去兼容更多的机型，更高的targetSdk和compileSdk来维护更好的性能。</p>
</li>
<li>
<p>versionCode</p>
</li>
<li>
<p>versionName</p>
</li>
<li>
<p>testInstrumentationRunner</p>
</li>
</ul>
<h5 id="configurationsall">configurations.all{} 对所有配置进行统一更改</h5>
<ol>
<li>添加依赖项：通过 <code>dependencies</code> 配置块，你可以向所有配置添加统一的依赖项。例如：</li>
</ol>
<p><code>groovy
   configurations.all {
       dependencies {
           implementation 'com.example:library:1.0.0'
       }
   }</code></p>
<p>这样可以确保所有配置都引入相同的依赖项。</p>
<ol>
<li>配置属性：你可以使用 <code>each</code> 方法遍历所有配置，并对每个配置进行属性设置。例如：</li>
</ol>
<p><code>groovy
   configurations.all {
       it.resolutionStrategy.cacheChangingModulesFor 0, 'seconds'
   }</code></p>
<p>这样可以设置所有配置的缓存策略。</p>
<ol>
<li>应用插件：通过 <code>apply</code> 方法，你可以在所有配置中应用相同的插件。例如：</li>
</ol>
<p><code>groovy
   configurations.all {
       apply plugin: 'com.example.myplugin'
   }</code></p>
<h5 id="buildtypes-apk">buildTypes{} 用于构建不同的Apk</h5>
<blockquote>
<p>开启混淆，区分debug/release/custon等</p>
</blockquote>
<pre><code class="language-grovvy">buildTypes {
        release {
            minifyEnabled true //开启混淆
            shrinkResources true //移除未使用资源
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            signingConfig signingConfigs.release //设置使用的签名
        }
        debug {
            debuggable true
        }
        custom {
            minifyEnabled false
        }
    }
</code></pre>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>applicationIdSuffix</td>
<td>配置applicationId的后缀</td>
</tr>
<tr>
<td>debuggable</td>
<td>是否支持断点调试</td>
</tr>
<tr>
<td>jniDebuggable</td>
<td>是否可以调试NDK代码</td>
</tr>
<tr>
<td>buildConfigField</td>
<td>配置不同的开发环境，比如测试环境和正式环境</td>
</tr>
<tr>
<td>shrinkResources</td>
<td>编译时是否移除未使用的资源，默认false</td>
</tr>
<tr>
<td>zipAlignEnabled</td>
<td>是否开启开启zipalign优化，提高apk运行效率</td>
</tr>
<tr>
<td>proguardFile</td>
<td>ProGuard混淆所使用的ProGuard配置文件</td>
</tr>
<tr>
<td>proguardFiles</td>
<td>同时配置多个ProGuard配置文件</td>
</tr>
<tr>
<td>signingConfig</td>
<td>配置签名信息</td>
</tr>
<tr>
<td>multiDexEnabled</td>
<td>是否自动拆分多个Dex</td>
</tr>
</tbody>
</table>
<h5 id="signingconfig">signingConfig{}</h5>
<blockquote>
<p><em>可以在bulidTypes下的signingConfig中引用</em></p>
</blockquote>
<pre><code class="language-groovy">    signingConfigs {
        debug {//可以在bulidTypes下的signingConfig中引用
            storeFile file('release.keystore')//签名文件路径
            storePassword 'xxxxxx'
            keyAlias 'androidreleasekey'
            keyPassword '123456'
        }
        release {
            storeFile file('release.keystore')
            storePassword 'xxxxxx'
            keyAlias 'androidreleasekey'
            keyPassword '123456'
        }
    }
</code></pre>
<h5 id="sourcesets">sourceSets{}</h5>
<blockquote>
<p>可以指定编译哪些源文件</p>
</blockquote>
<pre><code class="language-java">    sourceSets {
        main {
            manifest.srcFile 'AndroidManifest.xml'
            java.srcDirs = ['src']
            resources.srcDirs = ['src']
            aidl.srcDirs = ['src']
            renderscript.srcDirs = ['src']
            res.srcDirs = ['res']
            assets.srcDirs = ['assets']
            jniLibs.srcDirs = ['src/main/jniLibs']
            java {
                exclude '/test/**'  // 不想包含文件的路径
            }
        }
    }
</code></pre>
<h5 id="afterevaluate">afterEvaluate{}</h5>
<p>闭包可以用来在配置阶段结束后执行一些操作，通常用于对已解析的配置进行进一步处理或动态修改配置。</p>
<h4 id="ndk">NDK 配置</h4>
<p>1）defaultConfig{}中的 ndk.abiFilters 属性，配置ndk链接库支持的cpu架构</p>
<p>2）externalNativeBuild{}中配置cmake</p>
<pre><code>externalNativeBuild {
    cmake {
        path "CMakeLists.txt"
        cppFlags '-std=c++11'
        arguments '-DANDROID_PLATFORM=android-21',
                '-DANDROID_TOOLCHAIN=clang',
                '-DANDROID_STL=c++_shared'
    }
}
</code></pre>
<p>3）sourceSets中配置动态链接库的目录</p>
<pre><code>sourceSets {
    main {
        jniLibs.srcDirs = ['src/main/jniLibs']
    }
}
</code></pre>
<p>4）android {} ndkversion</p>
<ul>
<li>上传Library到maven</li>
</ul>
<pre><code class="language-java">apply plugin: 'maven'
//...其它配置
//将源码打包  为了保证引入的aar  包可以查看源码
task androidSourcesJar(type: Jar) {
    classifier = 'sources'
    from android.sourceSets.main.java.srcDirs
}
//包含文档和源码的aar
artifacts {
    archives androidSourcesJar
}
//上传到Maven仓库的task
uploadArchives {
    repositories {
        mavenDeployer {
            //指定maven仓库url
            repository(url: &quot;http://url/maven-releases/&quot;) {
                //nexus登录默认用户名和密码
                authentication(userName: &quot;admin&quot;, password: &quot;123456&quot;)
            }
            pom.groupId = &quot;com.test.camera&quot;// 唯一标识（通常为模块包名，也可以任意）
            pom.artifactId = &quot;CameraMix&quot; // 项目名称（通常为类库模块名称，也可以任意）
            pom.version = &quot;1.0.0&quot; // 版本号
        }
    }
}
//版本号每次上传必须换新，除非使用-SNAPSHOT
</code></pre>
<pre><code> compileOptions {//编译选项
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

 lintOptions {//lint配置
        checkReleaseBuilds false
        abortOnError false
    }
</code></pre>
<h3 id="3-buildgradle">3.自定义 build.gradle</h3>
<blockquote>
<p>可以自定义.gradle 文件 可以通过apply 将自定义的.gradle引入到build.gradle</p>
</blockquote>
<h3 id="4build-variants">4.<a href="https://developer.android.google.cn/studio/build/build-variants">Build variants</a></h3>
<blockquote>
<p>过配置 build 变体来根据单个项目构建出不同版本的应用，以及如何正确管理依赖项和签名配置。</p>
</blockquote>
<h3 id="5aab">5.AAB格式</h3>
<blockquote>
<p>2021年8月，google官方宣布都将使用Android App Bundles格式来上传打包文件。AAB格式是一种发布格式，它主要解决了通用的Apk因为要适配多地区、多机型带来的资源过多的问题，具有减少开发者负担、减少应用大小、安装时间和宽带消耗，它将构成一个Apk的操作交给了google play去完成，最终安装在手机上的还是Apk格式。</p>
</blockquote>
<ul>
<li>动态交付（google play Dynamic Delivery）</li>
</ul>
<p>Google play 根据AAB文件，将其从多个维度拆分，在资源维度、ABI维度和Launge维度进行了拆分，你只要按需组装你的Apk即可，比如你的手机是x86 ,xhdpi的手机，google play会获取手机信息，按照你需要的资源拼装成一个apk，而无关的资源会删除，减少了Apk的大小。</p>
<p>还可以将一个apk拆分成多个apk，按需加载，有以下几种split apk</p>
<ul>
<li>Base Apk 包含了所有其他拆分APK都可以访问的代码和资源，并提供应用的基本功能</li>
<li>Configuration Apks  native libraries 和适配当前手机屏幕分辨率的资源</li>
<li>Dynamic feature Apks. 每个动态功能都包含某项功能的代码和资源。</li>
</ul>
<h3 id="6settingsgradle">6.Settings.gradle</h3>
<blockquote>
<p>一般放在工程顶层,主要有以下几个功能：</p>
</blockquote>
<pre><code class="language-gro">pluginManagement {
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
    }
}
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
    }
}
rootProject.name = &quot;TestApplication&quot;
include ':app'
</code></pre>
<ul>
<li>pluginManagement 脚本块 等同于build.gradle的<code>buildprojects{}</code></li>
</ul>
<p>用于 配置 Gradle 插件的 Maven 仓库 ,配置的是构建过程 中 , 使用的仓库 ;</p>
<ul>
<li>dependencyResolutionManagement 脚本块</li>
</ul>
<p>用于 配置 依赖 的 Maven 仓库 ,配置的是工程或模块 下的依赖使用的仓库 ，等同于build.gradle的<code>allprojects{}</code></p>
<ul>
<li>dependencyResolutionManagement#repositoriesMode 模式有两种 :</li>
</ul>
<p>RepositoriesMode.PREFER_PROJECT : 解析依赖库时 , 优先使用本地仓库 , 本地仓库没有该依赖 , 则使用远程仓库 ;
RepositoriesMode.FAIL_ON_PROJECT_REPOS : 解析依赖库时 , 强行使用远程仓库 , 不管本地仓库有没有该依赖库 ;
 RepositoriesMode.PREFER_SETTINGS(false)--首选设置存储库</p>
<ul>
<li>rootProject.name 用于指定工程根目录 , 在该目录下有一个 build.gradle 构建脚本 , 声明后会自动执行该构建脚本 ;</li>
<li>include 用于指定子项目 , 在子项目中也有一个 build.gradle 构建脚本 , 声明后会自动执行该构建脚本 ;</li>
</ul>
<h2 id="_1">编译性能优化工具</h2>
<p>1.Android Studio Analyzer</p>
<blockquote>
<p>Android Studio 提供的可视化分析Build性能的工具。</p>
</blockquote>
<p>2.独立的 <a href="https://developer.android.google.cn/studio/build/profile-your-build#gradle-profiler"><code>gradle-profiler</code> 工具</a></p>
<blockquote>
<p>这是一款用于深入分析 build 的强大工具。</p>
</blockquote>
<p>3.Gradle <a href="https://developer.android.google.cn/studio/build/profile-your-build#gradle-profile-option"><code>--profile</code> 选项</a></p>
<blockquote>
<p>这是一款可从 Gradle 命令行启动的便捷工具。</p>
</blockquote>
<p>通过以下命令可以扫描编译时间</p>
<pre><code class="language-shell"> ./gradlew app:assembleDebug  --profile --scan
 ./gradlew --profile --offline --rerun-tasks assembleFlavorDebug
</code></pre>
<h1 id="gradle_1">常用的Gradle命令</h1>
<h2 id="gladletask"><a href="https://mp.weixin.qq.com/s?__biz=MzA5MzI3NjE2MA==&amp;mid=2650265470&amp;idx=1&amp;sn=b0a8a269958339a9e33b6777572c97bb&amp;chksm=88632611bf14af079ce3ee1df90dc4e830aa3c106a12def378a5c957ef948f0a1802cd51d404&amp;scene=27">打包过程中的Gladle的Task</a></h2>
<blockquote>
<p>Android 使用Gradle打包的过程是通过Android Gradle Plugin来完成的。</p>
</blockquote>
<p>通过<code>./gradlew assembleDebug --console plain &gt; tasks.txt</code>来查看gradle命令。</p>
<pre><code class="language-groovy">//aidl 转换aidl文件为java文件
&gt; Task :app:compileDebugAidl

//生成BuildConfig文件
&gt; Task :app:generateDebugBuildConfig

//获取gradle中配置的资源文件
&gt; Task :app:generateDebugResValues

// merge资源文件，AAPT2 编译阶段
&gt; Task :app:mergeDebugResources

// merge assets文件
&gt; Task :app:mergeDebugAssets
&gt; Task :app:compressDebugAssets

// merge所有的manifest文件
&gt; Task :app:processDebugManifest

//生成R文件 AAPT2 链接阶段
&gt; Task :app:processDebugResources

//编译kotlin文件
&gt; Task :app:compileDebugKotlin

//javac 编译java文件
&gt; Task :app:compileDebugJavaWithJavac

//转换class文件为dex文件
&gt; Task :app:dexBuilderDebug

//打包成apk并签名
&gt; Task :app:packageDebug
</code></pre>
<h2 id="gradle_2">Gradle常见问题整理</h2>
<p>1.Gradlew 依赖问题：<code>Program type already present: XXX</code></p>
<p>一般是依赖重复导致的，解决方案是排除重复的依赖。</p>
<p>排查依赖的命令：<code>./gradlew -q 模块名:dependencies</code>,会出现多个依赖树，</p>
<h1 id="gradle_3">Gradle 语法学习</h1>
<p>Gradle DSL（Domain Specific Language）是一种用于编写 Gradle 构建脚本的特定领域语言。它是基于 Groovy 语言的语法，并且为构建脚本提供了一组特定的语法和约定，用于定义构建任务、依赖关系、插件配置等。</p>
<p>Gradle 是一种开源的构建自动化工具，用于构建和管理项目的编译、测试、打包、部署等任务。它提供了一种灵活且强大的构建系统，支持多种编程语言和项目类型，并且具有高度可扩展性和定制性。</p>
<p>因此，Gradle DSL 是用于编写 Gradle 构建脚本的语言，而 Gradle 是构建工具本身。通过 Gradle DSL，开发者可以编写描述项目构建和管理的脚本，然后使用 Gradle 工具来执行这些脚本以完成相应的构建任务。Gradle DSL 提供了一种易于阅读和编写的语法，使得构建脚本的编写变得更加简洁和可维护。</p>
<h2 id="projecttask">Project和Task</h2>
<blockquote>
<p>每一个构建都是由一个或多个 projects 构成的. 一个 project 到底代表什么依赖于你想用 Gradle 做什么. 举个例子, 一个 project 可以代表一个 JAR 或者一个网页应用. 它也可能代表一个发布的 ZIP 压缩包, 这个 ZIP 可能是由许多其他项目的 JARs 构成的. 但是一个 project 不一定非要代表被构建的某个东西. 它可以代表一件**要做的事, 比如部署你的应用.</p>
</blockquote>
<ul>
<li>Project </li>
</ul>
<p>一个项目原则上是由多个Projects组成的，项目的根project是 root project</p>
<ul>
<li>Task</li>
</ul>
<p>在build.gradle文件或者自定义的.gradle文件中</p>
<pre><code class="language-groovy">// build.gradle
task hello {
    doLast {
        println 'Hello world!'
    }
}
//or
tasks.register(&quot;hello&quot;) {
    doLast {
        println 'Hello world!'
    }
}

//在控制台运行命令
./gradlew -q hello // Android 用户在根目录使用 ./gradlew
</code></pre>
<p><code>doFirst</code>:</p>
<ul>
<li>
<p>使用 <code>doFirst</code> 方法可以向任务添加将在任务执行时最先执行的操作。</p>
</li>
<li>
<p>如果对同一任务多次调用 <code>doFirst</code>，每次添加的操作都会被插入到前一个 <code>doFirst</code> 操作之前，形成逆序执行。</p>
</li>
</ul>
<p><strong><code>doLast</code>：</strong></p>
<ul>
<li>使用 <code>doLast</code> 方法可以向任务添加将在任务执行时最后执行的操作。</li>
<li>如果对同一任务多次调用 <code>doLast</code>，每次添加的操作都会被附加到前一个 <code>doLast</code> 操作之后，按照添加顺序执行。</li>
</ul>
<pre><code class="language-groovy">task myTask {
    doFirst {
        println 'First action'
    }
    doLast {
        println 'Last action'
    }
    doFirst {
        println 'Second action'
    }
    doLast {
        println 'Penultimate action'
    }
}
//执行顺序：
//Second action（第二次调用 doFirst）
//First action（第一次调用 doFirst）
//任务主体的默认操作（如果有）
//Penultimate action（第一次调用 doLast）
//Last action（第二次调用 doLast）
</code></pre>
<p>Task依赖</p>
<p>使用<code>dependsOn</code>、<code>finalizedBy</code> 来实现Task的依赖</p>
<pre><code class="language-groovy">task compile {
    dependsOn preCompile // preCompile 会在 compile 之前执行
    finalizedBy postCompile // postCompile 会在 compile 之后执行
    doLast {
        println 'Executing compile...'
    }
}
</code></pre>
<p><code>mustRunAfter</code>  在 compile之后执行</p>
<pre><code class="language-Groovy">tasks.named(&quot;postCompile&quot;).configure {
    mustRunAfter tasks.named(&quot;compile&quot;)
}
</code></pre>
<p>动态创建</p>
<p>这里是指在Task运行时，创建新的Task进行执行。</p>
<h2 id="task">插拔式扩展(使用已存在的Task)</h2>
<ul>
<li>afterEvaluate</li>
</ul>
<p>Gradle 的构建过程分为三个主要阶段：初始化、配置和执行。</p>
<p><strong>注册回调：</strong> 在配置阶段，您可以通过调用 <code>project.afterEvaluate { ... }</code> 方法来注册一个回调。该回调将在配置阶段结束后执行。</p>
<p><strong>执行回调：</strong> 当配置阶段完成时，Gradle 会调用所有已注册的 <code>afterEvaluate</code> 回调。这使得插件或构建脚本能够在项目配置完成后，根据最终的配置状态执行特定的逻辑。</p>
<p>想要将新的Task插入到其中,将依赖关系写好，就会执行，</p>
<p>举一个例子，在assembleDebug 命令的依赖树中mergeDebugAssets后添加一个checkAsset的命令，执行assembleDebug后执行。</p>
<p><code>Groovy
  project.project(":app").afterEvaluate {
      def p = project.pluginManager.findPlugin("com.android.application")
      if (p == null) {
          return
      }
      def ext = project.extensions.getByName("android")
      def variants = ext.applicationVariants
      variants.each {
          if (it.name == "debug") {
              tasks.register("checkAssetsDebug") {
                  dependsOn("mergeDebugAssets")
                  doLast {
                      check("debug")
                  }
              }
             tasks.named("assembleDebug").configure {
                  dependsOn("checkAssetsDebug")
              }
          }
      }
  }</code></p>
<p>Android 提供了androidComponents 来进行afterEvaluate来进行回调，上面的代码可以写成如下代码：</p>
<p>```Groovy
  androidComponents {
      onVariants(selector().withBuildType('debug')) { variant -&gt;
          println "debug ${variant}"
          // 获取 mergeDebugAssets 任务的名称
          def mergeAssetsTaskName = "mergedebugAssets"</p>
<pre><code>      // 注册新的任务
      tasks.register("checkAssetsDebug") {
          dependsOn(mergeAssetsTaskName)
          doLast {
              println "Executing custom task after ${mergeAssetsTaskName}"
              check("debug")
          }
      }
      afterEvaluate {
          tasks.named("assembleDebug").configure {
              dependsOn("checkAssetsDebug")
          }
      }
  }
</code></pre>
<p>}
  ```</p>
<ul>
<li>doLast </li>
</ul>
<p>该方式是修改Task，而不是提供一个新的Task，不建议这么执行修改</p>
<p><code>groovy
  project.tasks.named("mergeDebugAssets").doLast{ }</code></p>
<p><strong>AntBuilder</strong>来加载文件，现在只支持Groovy</p>
<h1 id="gradle-plugin">Gradle  Plugin学习</h1>
<p><a href="https://docs.gradle.org/current/userguide/custom_plugins.html#sec:custom_plugins_standalone_project">自定义Gradle插件</a></p>
<p>https://juejin.cn/post/6887581345384497165</p>
<p>https://www.jianshu.com/p/92504554d727</p>
<h2 id="groovy">Groovy语法简单学习</h2>
<blockquote>
<p>主要是对闭包的使用</p>
</blockquote>
<p>1.在build.gradle中直接使用Plugin使用插件</p>
<pre><code class="language-groovy">//在build.gradle 最简单的使用Plugin插件
class GreetingPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        project.task('pluginhello') {
            doLast {
                println 'Hello from the GreetingPlugin'
            }
        }
    }
}

// Apply the plugin
apply plugin: GreetingPlugin

&gt; gradle -q pluginhello
Hello from the GreetingPlugin
</code></pre>
<p>2.Plugin extension的使用</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../12%20Otto%E5%BA%93%E3%80%81IPCOtto%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Otto库、IPCOtto库的使用">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                Otto库、IPCOtto库的使用
              </div>
            </div>
          </a>
        
        
          
          <a href="../14%20Service/" class="md-footer__link md-footer__link--next" aria-label="下一页: Service">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Service
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>